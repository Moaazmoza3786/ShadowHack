---
title: "Indicators of Compromise (IOCs) and TTPs"
description: "Understanding the key threat intelligence concepts that power modern security operations."
difficulty: "Intermediate"
estimatedTime: "45 minutes"
tags: ["blue-team", "threat-intelligence", "iocs", "ttps", "soc"]
---

# IOCs and TTPs: The Language of Threat Intelligence

<InfoBox type="tip" title="Know Your Enemy">
Understanding IOCs and TTPs is like learning to read the **fingerprints** and **behavioral patterns** of attackers. The better you understand them, the faster you can detect and respond.
</InfoBox>

## What Are IOCs?

**Indicators of Compromise (IOCs)** are forensic artifacts that indicate a potential intrusion:

### Types of IOCs

| IOC Type | Example | Usefulness |
|----------|---------|------------|
| **IP Addresses** | `185.220.101.45` | Low (easily changed) |
| **Domain Names** | `evil-c2.example.com` | Medium |
| **File Hashes** | `MD5: a1b2c3d4e5f6...` | High (unique identifier) |
| **URLs** | `http://mal.site/payload.exe` | Medium |
| **Email Addresses** | `phisher@evil.com` | Low-Medium |
| **Registry Keys** | `HKLM\...\Run\malware` | High |
| **File Paths** | `C:\Temp\evil.exe` | Medium |
| **Mutex Names** | `Global\UNIQUE_MUTEX_123` | High |

<TerminalWindow title="IOC Examples in Action">
# Example IOCs from a ransomware incident

## Network IOCs
C2 Server: 185.220.101.45:443
Domain: update-service[.]net
DNS over HTTPS: https://dns.cloudflare[.]com

## File IOCs
Ransomware Binary: 
  SHA256: 7c5a0e6f8d2e4a1b3c5d7e9f0a2b4c6d8e0f2a4b6c8d0e2f4a6b8c0d2e4f6a8b
  MD5: a1b2c3d4e5f67890abcdef1234567890
  Filename: svchost32.exe
  Path: C:\Windows\Temp\svchost32.exe

## Host IOCs
Registry Persistence:
  HKCU\Software\Microsoft\Windows\CurrentVersion\Run\WinUpdate
Scheduled Task: \Microsoft\Windows\UpdateTask
Service Name: WindowsUpdateService
Mutex: Global\RANSOMWARE_MUTEX_2026
</TerminalWindow>

---

## The Pyramid of Pain

<InfoBox type="warning" title="Critical Concept">
The **Pyramid of Pain** (by David Bianco) shows how difficult it is for attackers to change different IOC types.
</InfoBox>

```
                    ┌───────────────┐
                    │     TTPs      │  ◀── VERY HARD to change
                    ├───────────────┤
                  ┌─┤    Tools      │
                  │ ├───────────────┤
                  │ │ Network/Host  │  ◀── Annoying to change
                  │ │   Artifacts   │
                  │ ├───────────────┤
                  │ │ Domain Names  │
                  │ ├───────────────┤
                  │ │ IP Addresses  │  ◀── EASY to change
                  │ ├───────────────┤
                  │ │  Hash Values  │  ◀── TRIVIAL to change
                  └─┴───────────────┘
```

**Key Insight**: Focus detection on **TTPs** and **Tools** - they're hardest for attackers to modify!

---

## What Are TTPs?

**Tactics, Techniques, and Procedures (TTPs)** describe **how** adversaries operate:

| Component | Definition | Example |
|-----------|------------|---------|
| **Tactic** | The "why" - attacker's goal | Initial Access |
| **Technique** | The "how" - method used | Spearphishing Attachment |
| **Procedure** | The specific implementation | Word doc with macro → PowerShell → Cobalt Strike |

### MITRE ATT&CK Framework

The ATT&CK framework categorizes known adversary TTPs:

<TerminalWindow title="Common Attack Techniques">
# Initial Access (TA0001)
- T1566.001: Phishing - Spearphishing Attachment
- T1566.002: Phishing - Spearphishing Link
- T1078: Valid Accounts

# Execution (TA0002)
- T1059.001: PowerShell
- T1059.003: Windows Command Shell
- T1204.002: User Execution - Malicious File

# Persistence (TA0003)
- T1547.001: Registry Run Keys
- T1053.005: Scheduled Task
- T1136.001: Local Account Creation

# Privilege Escalation (TA0004)
- T1548.002: Bypass UAC
- T1068: Exploitation for Privilege Escalation

# Defense Evasion (TA0005)
- T1027: Obfuscated Files or Information
- T1070.004: File Deletion
- T1562.001: Disable Security Tools

# Credential Access (TA0006)
- T1003.001: LSASS Memory (Mimikatz)
- T1110: Brute Force

# Lateral Movement (TA0008)
- T1021.001: Remote Desktop Protocol
- T1021.002: SMB/Windows Admin Shares
- T1021.006: Windows Remote Management
</TerminalWindow>

---

## IOCs vs TTPs: Comparison

| Aspect | IOCs | TTPs |
|--------|------|------|
| **Focus** | Artifacts (what) | Behavior (how) |
| **Lifespan** | Short (change often) | Long (hard to change) |
| **Detection** | Signature-based | Behavioral/Anomaly |
| **Examples** | Hash, IP, Domain | PowerShell execution, lateral movement |
| **Response** | Block/blacklist | Hunt/detect patterns |

<InfoBox type="tip" title="Best Practice">
Use IOCs for **immediate blocking** and TTPs for **proactive hunting**. A mature SOC does both.
</InfoBox>

---

## Working with Threat Intelligence

### Intelligence Lifecycle

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│ Collection  │ ──▶ │ Processing  │ ──▶ │  Analysis   │
│ (Feeds,OSINT│     │ (Normalize, │     │ (Correlate, │
│  Reports)   │     │  Validate)  │     │  Enrich)    │
└─────────────┘     └─────────────┘     └─────────────┘
                                              │
                                              ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  Feedback   │ ◀── │ Consumption │ ◀── │   Output    │
│ (Improve    │     │ (SOC, IR,   │     │ (Reports,   │
│  Sources)   │     │  Hunting)   │     │  Alerts)    │
└─────────────┘     └─────────────┘     └─────────────┘
```

### Threat Intelligence Sources

| Source Type | Examples | Cost |
|-------------|----------|------|
| **Open Source (OSINT)** | AlienVault OTX, Abuse.ch, VirusTotal | Free |
| **Commercial Feeds** | Recorded Future, ThreatConnect, Mandiant | $$$ |
| **Government/ISAC** | CISA, MS-ISAC, Sector ISACs | Free/Membership |
| **Internal** | Your own incident data | Time |

---

## Practical Exercise

<ChallengeBox 
  title="Classify the Indicators"
  difficulty="medium"
  points={75}
>

Given the following incident data, classify each indicator and rate its value using the Pyramid of Pain:

```
Incident: Corporate network compromised via phishing email

Collected Indicators:
1. Email subject: "Invoice #2026-001 Attached"
2. Attachment hash (SHA256): 8a7b6c5d4e3f2a1b0c9d8e7f6a5b4c3d...
3. PowerShell command: IEX (New-Object Net.WebClient).DownloadString('http://...')
4. C2 IP: 45.33.32.156
5. Cobalt Strike beacon with specific OPSEC profile
6. Scheduled task named "ChromeUpdate" for persistence
```

**Questions**:
1. Which indicator provides the MOST detection value over time?
2. Which indicator is EASIEST for the attacker to change?
3. How would you prioritize detection efforts?

<details>
<summary>Answer</summary>

**1. Most Detection Value**: The PowerShell download cradle pattern (TTP) - This technique is used across many campaigns and is hard to change fundamentally.

**2. Easiest to Change**: The file hash - A single byte change creates a completely different hash.

**3. Detection Prioritization**:
1. **TTP** (PowerShell cradle pattern) - Create behavioral detection
2. **Tool** (Cobalt Strike profile) - JA3 fingerprints, malleable C2 patterns
3. **Host Artifact** (Scheduled task pattern) - Monitor task creation
4. **Network** (C2 IP) - Block but expect short-lived value
5. **Hash** - Block but it's one-time use

</details>
</ChallengeBox>

---

## Key Takeaways

- **IOCs** are forensic artifacts; **TTPs** describe adversary behavior
- The **Pyramid of Pain** guides detection prioritization
- Focus resources on **TTPs** for durable detection
- Use IOCs for **immediate response** and blocking
- **MITRE ATT&CK** is the standard framework for TTPs

<Quiz
  question="According to the Pyramid of Pain, which indicator type is HARDEST for an attacker to change?"
  options={[
    "IP Addresses",
    "File Hashes",
    "TTPs (Tactics, Techniques, Procedures)",
    "Domain Names"
  ]}
  correctIndex={2}
  explanation="TTPs are at the top of the Pyramid of Pain because they represent fundamental attacker behavior that's difficult to modify without developing entirely new capabilities."
/>
