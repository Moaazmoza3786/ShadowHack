
# Understanding CVSS Scoring (v3.1 vs v4.0)

## The Matrix of Security
When a vulnerability is found, how do we know if it's a "drop everything and fix this" or a "fix it next month" issue? We use the **Common Vulnerability Scoring System (CVSS)**.

CVSS provides a score from **0.0 to 10.0**.
-   **0.0:** None
-   **0.1 - 3.9:** Low
-   **4.0 - 6.9:** Medium
-   **7.0 - 8.9:** High
-   **9.0 - 10.0:** Critical

## 1. The CVSS Vector String
A score comes from a "Vector String". You must learn to read this like a sentence.

`CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H` (Score: 9.8 Critical)

| Metric | Code | Meaning | Impact |
| :--- | :--- | :--- | :--- |
| **Attack Vector** | `AV:N` | **Network:** Attacker can exploit this remotely (Internet). | High Risk |
| **Attack Complexity** | `AC:L` | **Low:** No special conditions (like a race condition) needed. | High Risk |
| **Privileges Required** | `PR:N` | **None:** An unauthorized user can do this. | High Risk |
| **User Interaction** | `UI:N` | **None:** The victim doesn't need to click anything. | High Risk |
| **Scope** | `S:U` | **Unchanged:** The exploit affects only the vulnerable component. | Normal Risk |
| **CIA Triad** | `C:H I:H A:H` | **Confidentiality, Integrity, Availability:** All High. | Critical Risk |

## 2. Temporal & Environmental Metrics
The "Base Score" (9.8 above) is just the theoretical severity.
-   **Temporal:** Is there an exploit code available? (Exploit Code Maturity: High/Functional/Proof-of-Concept).
-   **Environmental:** Is this server critical? (Modified Base Metrics).

<Mermaid chart={`
graph TD
    Base[Base Score<br>The Bug Itself] -->|Adjusted by| Temporal[Temporal Score<br>Current State of Exploit]
    Temporal -->|Adjusted by| Env[Environmental Score<br>Your Specific Context]
    Env --> Final[Final Risk Score]
    
    style Final fill:#b91c1c,stroke:#fff,stroke-width:2px,color:#fff
`} />

## 3. CVSS v4.0: The New Standard
Released in late 2023, v4.0 introduces key changes:
-   **Attack Requirements (AT):** Separates "Complexity" from "Pre-conditions".
-   **User Interaction:** Granular details (Active vs Passive).
-   **Safety (S):** Safety impact (Physical harm) is now explicitly modeled for OT/IoT environments.

## Interactive CVSS Calculator
Adjust the vector to see how the score changes (Conceptual).

<CodeBlock language="javascript" showLineNumbers code={`// How CVSS Scoring Logic Works (simplified)
function calculateCVSS(AV, AC, PR, UI) {
    let score = 0;
    if (AV === 'Network') score += 5;
    if (AV === 'Local') score += 1; // Harder to exploit
    
    if (PR === 'None') score += 3; // No login needed
    if (PR === 'High') score -= 2; // Needs Admin privileges (Lower Risk)
    
    return score;
}

// Scenario: Remote Code Execution (RCE) vs Local Privilege Escalation (LPE)
console.log(calculateCVSS('Network', 'Low', 'None', 'None')); // High Score
console.log(calculateCVSS('Local', 'High', 'High', 'None'));  // Lower Score
`} />

<Note type="warning">
**Risk != CVSS:** A CVSS 10.0 on a test server with no data is **Low Risk**. A CVSS 5.0 on the CEO's laptop might be **High Risk**. Risk = Severity x Likelihood x Asset Value.
</Note>

---

<Quiz 
    question="A vulnerability has a vector of AV:P (Attack Vector: Physical). What does this mean?" 
    options={[
        "The attacker exploits it via the Internet",
        "The attacker exploits it via Bluetooth",
        "The attacker must physically plug a USB device into the server",
        "The attacker exploits it via Phishing"
    ]} 
    answer="The attacker must physically plug a USB device into the server" 
/>
