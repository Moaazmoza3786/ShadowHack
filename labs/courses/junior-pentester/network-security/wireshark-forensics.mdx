---
title: "Wireshark: Traffic Analysis & Pcap Forensics"
path: "Junior Penetration Tester"
module: "Network Security & Tools"
difficulty: "Intermediate"
---

# Wireshark: Traffic Analysis & Pcap Forensics

**Wireshark** is the world’s foremost network protocol analyzer. It lets you see what’s happening on your network at a microscopic level. 

While Nmap tells you what ports are open, Wireshark shows you the actual data flowing through those ports. It is essential for both attacking (sniffing traffic) and defending (detecting attacks).

---

## 1. Capturing Traffic

Wireshark captures data from a Network Interface Card (NIC) and presents it in a human-readable format. Data is often saved in a **.pcap** (Packet Capture) file.

### Capture Interfaces:
- **eth0**: Your primary wired connection.
- **wlan0**: Your wireless connection.
- **lo**: Loopback (traffic staying on your own computer).

---

## 2. The Power of Filters

A busy network can generate thousands of packets per second. To find the "needle in the haystack," you must use **Display Filters**.

| Filter | Description |
| :--- | :--- |
| **ip.addr == 10.10.10.5** | Show only traffic involving this IP. |
| **tcp.port == 80** | Show only web traffic. |
| **http.request.method == "POST"** | Show only submitted data (passwords/forms). |
| **icmp** | Show only Ping requests and replies. |
| **dns** | Show all domain name lookups. |

---

## 3. Following Stream (The "Clean" View)

Looking at individual packets is hard. Wireshark’s **Follow TCP Stream** feature allows you to see the entire conversation between two computers as if it were a single text document.

<PacketView src="Client" dst="Server" flags="HTTP POST" data="[Follow TCP Stream] -> username=admin&password=hunter2" />

<InfoBox type="warning">
**Security Alert:** If the traffic is **NOT** encrypted (HTTP, Telnet, FTP), anyone sniffing the network with Wireshark can read every single character sent, including credentials.
</InfoBox>

---

## 4. Identifying Attacks in Wireshark

Hackers leave footprints in the traffic.
- **SYN Flood**: Thousands of SYN packets with no ACKs.
- **ARP Spoofing**: Multiple MAC addresses claiming to own the same IP.
- **Large DNS Queries**: Might indicate **DNS Tunneling** (exfiltrating data).

---

## Knowledge Check

<Quiz 
  question="Which display filter in Wireshark would you use to find only the packets where a user is submitting data to a website via a POST request?"
  options={["http", "ip.addr == 80", "http.request.method == 'POST'", "tcp.flags.push == 1"]}
  answer="http.request.method == 'POST'"
  explanation="This specific filter isolates HTTP requests using the POST method, which is typically used for submitting form data and passwords."
/>
