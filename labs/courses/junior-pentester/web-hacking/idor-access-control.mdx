---
title: "IDOR (Insecure Direct Object Reference)"
path: "Junior Penetration Tester"
module: "Web Hacking Fundamentals"
difficulty: "Intermediate"
---

# IDOR (Insecure Direct Object Reference)

**IDOR** is a type of access control vulnerability that occurs when an application uses user-supplied input to access objects directly. It is one of the most common and high-impact web vulnerabilities.

Think of it like this: You are in a hotel and your keycard works for your room (Room 101). But you notice the door handles are just numbers. You decide to try the handle for Room 102, and it just opens.

---

## How IDOR Works

Websites often use IDs in the URL or in request bodies to reference specific data (like your profile, an invoice, or a message).

**Example URL:**
`https://antigravity.hub/api/download_invoice?id=12345`

If the application only checks if you are logged in, but **not** if you own invoice `12345`, an attacker can simply change the ID to see other people's invoices.

**Attack:**
Changing `id=12345` to `id=12346`.

---

## Where to Look for IDOR

IDOR isn't just in the URL. It can be found in:

1. **Parameters**: `GET /view_user?user_id=88`
2. **Body Data**: `POST /update_password` with `{ "uid": 88, "pass": "new" }`
3. **Cookies**: A cookie like `user_id=88` that can be modified to `1`.

---

## Impact

The impact of IDOR can range from a minor information leak to a full account takeover.

<InfoBox type="warning">
**Advanced IDOR:** Sometimes IDs are not simple numbers (1, 2, 3). They might be **UUIDs** (Long strings like `550e8400-e29b-41d4-a716-446655440000`). While harder to guess, they are still vulnerable to IDOR if you can find a list of UUIDs somewhere else (like in a public forum or a search engine).
</InfoBox>

---

## Interactive Identification

Let's simulate a profile page vulnerability.

<TerminalWindow cmd="curl http://social.hub/api/profile/99" output="{
  'username': 'bob_hacker',
  'email': 'bob@hacker.com',
  'secret_note': 'I love cat videos'
}" />

<TerminalWindow cmd="curl http://social.hub/api/profile/1" output="{
  'username': 'admin',
  'email': 'admin@system.local',
  'backup_key': 'KEY_12345_67890'
}
[!] IDOR SUCCESS: Admin data accessed by Bob." />

---

## Knowledge Check

<Quiz 
  question="What is the root cause of an IDOR vulnerability?"
  options={[
    "Using a database",
    "Failing to check if a user is authorized for a specific resource",
    "Using numbers in URLs",
    "Not using HTTPS"
  ]}
  answer="Failing to check if a user is authorized for a specific resource"
  explanation="Even if an ID is public, the server must verify that the requesting user has the right to access that specific object."
/>
