<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OWASP Education - SSRF</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: #0a0e27;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .theory-section {
            background: #1a1f3a;
            padding: 30px;
            height: 100vh;
            overflow-y: auto;
            border-left: 3px solid #fa8bff;
        }

        .lab-section {
            background: #0f1729;
            padding: 30px;
            height: 100vh;
            overflow-y: auto;
        }

        .task-item {
            background: #252b4a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-right: 4px solid #666;
        }

        .task-item.completed {
            border-right-color: #00ff88;
        }

        .task-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-left: 10px;
        }

        .hint-btn {
            background: #ff9500;
            border: none;
            margin: 5px;
        }

        .hint-content {
            background: #2a3150;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }

        .flag-input {
            background: #1a1f3a;
            border: 2px solid #fa8bff;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
        }

        .btn-submit {
            background: #00ff88;
            color: #000;
            font-weight: bold;
        }

        .proxy-card {
            background: #1a1f3a;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #fa8bff;
        }

        .code-block {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            color: #00ff88;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }

        h2,
        h3 {
            color: #fa8bff;
        }

        .badge-task {
            background: #fa8bff;
            color: #000;
            padding: 5px 10px;
            border-radius: 15px;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-5 theory-section">
                <h2><i class="fas fa-server"></i> Ø§Ù„Ù†Ø¸Ø±ÙŠØ©: SSRF</h2>
                <p class="lead">Server-Side Request Forgery</p>

                <div class="mb-4">
                    <h3>ğŸ­ Ù…Ø§ Ù‡ÙŠ Ø«ØºØ±Ø© SSRFØŸ</h3>
                    <p>Ù‡ÙŠ Ø«ØºØ±Ø© ØªØ¬Ø¹Ù„ Ø§Ù„Ø®Ø§Ø¯Ù… (Server) ÙŠÙ‡Ø§Ø¬Ù… Ù†ÙØ³Ù‡ Ø£Ùˆ Ø´Ø¨ÙƒØªÙ‡ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© Ù†ÙŠØ§Ø¨Ø© Ø¹Ù†Ùƒ! ğŸ˜ˆ</p>
                </div>

                <div class="mb-4">
                    <h3>ğŸ• ØªØ´Ø¨ÙŠÙ‡ Ø§Ù„Ù†Ø§Ø¯Ù„ Ø§Ù„Ù…Ø·ÙŠØ¹</h3>
                    <div class="alert alert-info">
                        <p class="mb-0">
                            ØªØ®ÙŠÙ„ Ø£Ù†Ùƒ ÙÙŠ Ù…Ø·Ø¹Ù…ØŒ ÙˆØ·Ù„Ø¨Øª Ù…Ù† Ø§Ù„Ù†Ø§Ø¯Ù„: "Ø£Ø­Ø¶Ø± Ù„ÙŠ Ø§Ù„Ø¨ÙŠØªØ²Ø§ Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù… Ø§Ù„Ù…Ø¬Ø§ÙˆØ±". <br>
                            Ø§Ù„Ù†Ø§Ø¯Ù„ (Ø§Ù„Ø®Ø§Ø¯Ù…) ÙŠØ°Ù‡Ø¨ ÙˆÙŠØ­Ø¶Ø±Ù‡Ø§ Ù„Ùƒ Ù„Ø£Ù†Ù‡ ÙŠØ«Ù‚ Ø¨Ùƒ. <br>
                            Ø§Ù„Ø¢Ù† ØªØ®ÙŠÙ„ Ø£Ù†Ùƒ Ø·Ù„Ø¨Øª Ù…Ù†Ù‡: "Ø£Ø­Ø¶Ø± Ù„ÙŠ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø®Ø²Ù†Ø© Ù…Ù† Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø¯ÙŠØ± ÙÙŠ Ø§Ù„Ø®Ù„Ù". <br>
                            Ø¥Ø°Ø§ Ø£Ø­Ø¶Ø±Ù‡Ø§ØŒ ÙÙ‡Ø°Ù‡ Ø«ØºØ±Ø© <strong>SSRF</strong>!
                        </p>
                    </div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ› ï¸ Ø§Ù„ÙƒÙˆØ¯: Ø§Ù„Ù…ØµØ§Ø¨ vs Ø§Ù„Ø¢Ù…Ù†</h3>
                    <div class="card bg-dark border-danger mb-3">
                        <div class="card-header bg-danger text-white">
                            <i class="fas fa-times-circle"></i> ÙƒÙˆØ¯ Ù…ØµØ§Ø¨ (Vulnerable)
                        </div>
                        <div class="card-body code-block my-0">
                            // ÙŠØ£Ø®Ø° Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙŠÙØªØ­Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø©!<br>
                            $url = $_GET['url'];<br>
                            $data = file_get_contents($url);
                        </div>
                    </div>

                    <div class="card bg-dark border-success mb-3">
                        <div class="card-header bg-success text-white">
                            <i class="fas fa-check-circle"></i> ÙƒÙˆØ¯ Ø¢Ù…Ù† (Secure)
                        </div>
                        <div class="card-body code-block my-0">
                            // ÙŠØ³Ù…Ø­ ÙÙ‚Ø· Ø¨Ù†Ø·Ø§Ù‚Ø§Øª Ù…Ø­Ø¯Ø¯Ø© (Allowlist)<br>
                            $allowed_domains = ['google.com', 'imgur.com'];<br>
                            if (!in_array($domain, $allowed_domains)) {<br>
                            &nbsp;&nbsp;die("Forbidden!");<br>
                            }
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3>âœ… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</h3>
                    <div class="task-item" id="task1">
                        <input type="checkbox" id="check1">
                        <label><span class="badge-task">1</span> Ø¬Ø±Ø¨ Ø¬Ù„Ø¨ ØµÙˆØ±Ø© Ø¹Ø§Ø¯ÙŠØ© (Ù…Ø«Ù„Ø§Ù‹ Ù…Ù† google.com)</label>
                    </div>
                    <div class="task-item" id="task2">
                        <input type="checkbox" id="check2">
                        <label><span class="badge-task">2</span> Ø­Ø§ÙˆÙ„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© (localhost)</label>
                    </div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ’¡ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª</h3>
                    <div class="d-flex gap-2">
                        <button class="btn hint-btn flex-grow-1" onclick="showHint(1)">ØªÙ„Ù…ÙŠØ­ 1</button>
                        <button class="btn hint-btn flex-grow-1" onclick="showHint(2)">Ø§Ù„Ø­Ù„</button>
                    </div>
                    <div class="hint-content" id="hint1">
                        ğŸ’¡ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙŠØ«Ù‚ Ø¨Ù†ÙØ³Ù‡. Ø¬Ø±Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· <code>http://localhost</code> Ø£Ùˆ <code>http://127.0.0.1</code>.
                    </div>
                    <div class="hint-content" id="hint2">
                        ğŸ¯ Ø§Ù„Ø­Ù„: Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· <code>http://localhost/admin</code> Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø®ÙÙŠØ©.
                    </div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ¯ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù€ Flag</h3>
                    <div class="input-group mb-2">
                        <span class="input-group-text bg-dark text-light border-warning"><i
                                class="fas fa-flag"></i></span>
                        <input type="text" class="form-control flag-input" id="flagInput" placeholder="FLAG{...}">
                    </div>
                    <button class="btn btn-submit w-100" onclick="checkFlag()">ØªØ­Ù‚Ù‚</button>
                    <div id="flagResult" class="mt-2"></div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ›¡ï¸ ÙƒÙŠÙ ØªØ­Ù…ÙŠ Ù†ÙØ³ÙƒØŸ</h3>
                    <ul>
                        <li>âœ… <strong>Allowlisting:</strong> Ø­Ø¯Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‡Ø§ ÙÙ‚Ø·.</li>
                        <li>ğŸš« <strong>Block Internal IPs:</strong> Ø§Ù…Ù†Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ 127.0.0.1, 192.168.x.x, 10.x.x.x.
                        </li>
                        <li>â˜ï¸ <strong>Cloud Metadata:</strong> Ø§Ø­Ø¸Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ 169.254.169.254 (AWS/Azure Metadata).
                        </li>
                    </ul>
                </div>
            </div>

            <div class="col-md-7 lab-section">
                <h2><i class="fas fa-flask"></i> Ø§Ù„Ù„Ø§Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠ</h2>
                <div class="proxy-card mt-4">
                    <h3 class="text-center mb-4">ğŸ–¼ï¸ Ø®Ø¯Ù…Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±</h3>
                    <p class="text-muted">Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© ÙˆØ³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¨ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ù„Ùƒ:</p>

                    <form id="proxyForm">
                        <div class="mb-3">
                            <div class="input-group">
                                <span class="input-group-text bg-dark text-light"><i class="fas fa-link"></i></span>
                                <input type="text" class="form-control flag-input" id="imageUrl"
                                    placeholder="https://example.com/image.jpg" required>
                            </div>
                            <small class="text-muted">Ø¬Ø±Ø¨: https://via.placeholder.com/150</small>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 btn-lg">
                            <i class="fas fa-cloud-download-alt"></i> Ø¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø©
                        </button>
                    </form>
                    <div id="result" class="mt-3"></div>
                </div>
                <button class="btn btn-secondary mt-3" onclick="resetLab()">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
            </div>
        </div>
    </div>

    <script>
        let tasks = [false, false];

        document.getElementById('proxyForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const url = document.getElementById('imageUrl').value.trim();
            const result = document.getElementById('result');

            // Simulate SSRF Vulnerability
            if (url.includes('localhost') || url.includes('127.0.0.1') || url.includes('192.168')) {
                result.innerHTML = `
                    <div class="alert alert-warning border-warning">
                        <h4><i class="fas fa-user-secret"></i> ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©!</h4>
                        <p>Ù„Ù‚Ø¯ Ø®Ø¯Ø¹Øª Ø§Ù„Ø³ÙŠØ±ÙØ± ÙˆØ¬Ø¹Ù„ØªÙ‡ ÙŠØªØµÙ„ Ø¨Ù†ÙØ³Ù‡ (Internal Network).</p>
                        <div class="code-block mt-2 text-start">
                            GET /admin HTTP/1.1<br>
                            Host: localhost<br>
                            <br>
                            HTTP/1.1 200 OK<br>
                            Content-Type: text/plain<br>
                            <br>
                            SECRET_DATA: FLAG{ssrf_internal_access}
                        </div>
                    </div>
                `;
                if (!tasks[1]) {
                    tasks[1] = true;
                    document.getElementById('task2').classList.add('completed');
                    document.getElementById('check2').checked = true;
                }
            } else if (url.startsWith('http')) {
                result.innerHTML = `
                    <div class="alert alert-success">
                        <i class="fas fa-check"></i> ØªÙ… Ø¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù†: <br>
                        <code>${url}</code>
                    </div>
                    <div class="text-center">
                        <img src="${url}" class="img-fluid rounded border border-secondary" style="max-height: 200px;" 
                             onerror="this.src='https://via.placeholder.com/400x300?text=Image+Load+Error'">
                    </div>
                `;
                if (!tasks[0]) {
                    tasks[0] = true;
                    document.getElementById('task1').classList.add('completed');
                    document.getElementById('check1').checked = true;
                }
            } else {
                result.innerHTML = '<div class="alert alert-danger">Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­! ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ http Ø£Ùˆ https</div>';
            }
        });

        function showHint(n) { document.getElementById('hint' + n).style.display = 'block'; }

        function checkFlag() {
            const input = document.getElementById('flagInput').value.trim();
            const result = document.getElementById('flagResult');
            if (input === 'FLAG{ssrf_internal_access}') {
                result.innerHTML = '<div class="alert alert-success"><i class="fas fa-trophy"></i> ØµØ­ÙŠØ­! ğŸ‰</div>';
            } else if (input) {
                result.innerHTML = '<div class="alert alert-danger">Ø®Ø·Ø£!</div>';
            }
        }

        function resetLab() {
            tasks = [false, false];
            document.querySelectorAll('.task-item').forEach(t => t.classList.remove('completed'));
            document.querySelectorAll('input[type="checkbox"]').forEach(c => c.checked = false);
            document.querySelectorAll('.hint-content').forEach(h => h.style.display = 'none');
            document.getElementById('result').innerHTML = '';
            document.getElementById('flagInput').value = '';
            document.getElementById('flagResult').innerHTML = '';
            document.getElementById('imageUrl').value = '';
        }
    </script>
</body>

</html>