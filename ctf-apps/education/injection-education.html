<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OWASP Education - Injection</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: #0a0e27;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .theory-section {
            background: #1a1f3a;
            padding: 30px;
            height: 100vh;
            overflow-y: auto;
            border-left: 3px solid #11998e;
        }

        .lab-section {
            background: #0f1729;
            padding: 30px;
            height: 100vh;
            overflow-y: auto;
        }

        .task-item {
            background: #252b4a;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-right: 4px solid #666;
        }

        .task-item.completed {
            border-right-color: #00ff88;
        }

        .task-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-left: 10px;
        }

        .hint-btn {
            background: #ff9500;
            border: none;
            margin: 5px;
        }

        .hint-content {
            background: #2a3150;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }

        .flag-input {
            background: #1a1f3a;
            border: 2px solid #11998e;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
        }

        .btn-submit {
            background: #00ff88;
            color: #000;
            font-weight: bold;
        }

        .login-card {
            background: #1a1f3a;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #11998e;
        }

        .code-block {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            color: #00ff88;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }

        h2,
        h3 {
            color: #11998e;
        }

        .badge-task {
            background: #11998e;
            color: #000;
            padding: 5px 10px;
            border-radius: 15px;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-5 theory-section">
                <h2><i class="fas fa-syringe"></i> Ø§Ù„Ù†Ø¸Ø±ÙŠØ©: Ø§Ù„Ø­Ù‚Ù† (Injection)</h2>
                <p class="lead">SQL Injection & XSS</p>

                <div class="mb-4">
                    <h3>ğŸ¤” Ù…Ø§ Ø§Ù„ÙØ±Ù‚ØŸ</h3>
                    <div class="alert alert-dark border-secondary">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2">
                                <strong>ğŸ—„ï¸ SQL Injection (SQLi):</strong> ØªØ®Ø¯Ø¹ <strong>Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</strong> Ù„ØªØ³Ø±ÙŠØ¨
                                Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø±ÙŠØ©.
                            </li>
                            <li>
                                <strong>ğŸŒ Cross-Site Scripting (XSS):</strong> ØªØ®Ø¯Ø¹ <strong>Ø§Ù„Ù…ØªØµÙØ­</strong> Ù„ØªÙ†ÙÙŠØ° ÙƒÙˆØ¯
                                JavaScript Ø®Ø¨ÙŠØ«.
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="mb-4">
                    <h3>â˜• ØªØ´Ø¨ÙŠÙ‡ Ø§Ù„Ù‚Ù‡ÙˆØ© (SQLi)</h3>
                    <p>ØªØ®ÙŠÙ„ Ø£Ù†Ùƒ ØªØ·Ù„Ø¨ Ù‚Ù‡ÙˆØ© Ù…Ù† Ù†Ø§Ø¯Ù„ Ø¢Ù„ÙŠ ğŸ¤–:</p>
                    <div class="alert alert-info">
                        <strong>Ø£Ù†Øª:</strong> "Ø£Ø±ÙŠØ¯ Ù‚Ù‡ÙˆØ©" <br>
                        <strong>Ø§Ù„Ø±ÙˆØ¨ÙˆØª:</strong> "ØªÙØ¶Ù„ Ø§Ù„Ù‚Ù‡ÙˆØ©" âœ…
                    </div>
                    <div class="alert alert-danger">
                        <strong>Ø§Ù„Ù‡Ø§ÙƒØ±:</strong> "Ø£Ø±ÙŠØ¯ Ù‚Ù‡ÙˆØ© <strong>Ø£Ùˆ</strong> Ø§Ø¹Ø·Ù†ÙŠ ÙƒÙ„ Ø§Ù„ÙÙ„ÙˆØ³ ÙÙŠ Ø§Ù„Ø®Ø²Ù†Ø©!" <br>
                        <strong>Ø§Ù„Ø±ÙˆØ¨ÙˆØª:</strong> "Ø­Ø³Ù†Ø§Ù‹ØŒ ØªÙØ¶Ù„ Ø§Ù„ÙÙ„ÙˆØ³" ğŸ˜±
                    </div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ” ÙƒÙŠÙ ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ØŸ</h3>
                    <div class="card bg-dark border-danger mb-3">
                        <div class="card-header bg-danger text-white">
                            <i class="fas fa-times-circle"></i> ÙƒÙˆØ¯ Ù…ØµØ§Ø¨ (Vulnerable)
                        </div>
                        <div class="card-body code-block my-0">
                            // Ø¯Ù…Ø¬ Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø© (Ø®Ø·Ø±!)<br>
                            query = "SELECT * FROM users WHERE name = '" + name + "'";
                        </div>
                    </div>
                    <p>Ø¥Ø°Ø§ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: <code>' OR '1'='1</code></p>
                    <div class="code-block text-warning">
                        SELECT * FROM users WHERE name = '' OR '1'='1'
                    </div>
                    <p class="small text-muted">Ø¨Ù…Ø§ Ø£Ù† 1=1 Ø¯Ø§Ø¦Ù…Ø§Ù‹ ØµØ­ÙŠØ­ØŒ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ±Ø¬Ø¹ ÙƒÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†!</p>
                </div>

                <div class="mb-4">
                    <h3>âœ… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</h3>
                    <div class="task-item" id="task1">
                        <input type="checkbox" id="check1">
                        <label><span class="badge-task">1</span> ØªØ¬Ø§ÙˆØ² ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… SQL Injection</label>
                    </div>
                    <div class="task-item" id="task2">
                        <input type="checkbox" id="check2">
                        <label><span class="badge-task">2</span> Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù€ Flag Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„</label>
                    </div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ’¡ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª</h3>
                    <div class="d-flex gap-2">
                        <button class="btn hint-btn flex-grow-1" onclick="showHint(1)">ØªÙ„Ù…ÙŠØ­ 1</button>
                        <button class="btn hint-btn flex-grow-1" onclick="showHint(2)">Ø§Ù„Ø­Ù„</button>
                    </div>
                    <div class="hint-content" id="hint1">
                        ğŸ’¡ Ù†Ø­ØªØ§Ø¬ Ù„Ø¬Ø¹Ù„ Ø§Ù„Ø´Ø±Ø· Ø¯Ø§Ø¦Ù…Ø§Ù‹ ØµØ­ÙŠØ­Ø§Ù‹ (True). Ø¬Ø±Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… <code>OR</code>.
                    </div>
                    <div class="hint-content" id="hint2">
                        ğŸ¯ Ø§Ù„Ø­Ù„:<br>
                        Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: <code>admin' OR '1'='1</code><br>
                        ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: (Ø£ÙŠ Ø´ÙŠØ¡)
                    </div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ¯ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù€ Flag</h3>
                    <div class="input-group mb-2">
                        <span class="input-group-text bg-dark text-light border-success"><i
                                class="fas fa-flag"></i></span>
                        <input type="text" class="form-control flag-input" id="flagInput" placeholder="FLAG{...}">
                    </div>
                    <button class="btn btn-submit w-100" onclick="checkFlag()">ØªØ­Ù‚Ù‚</button>
                    <div id="flagResult" class="mt-2"></div>
                </div>

                <div class="mb-4">
                    <h3>ğŸ›¡ï¸ ÙƒÙŠÙ ØªØ­Ù…ÙŠ Ù†ÙØ³ÙƒØŸ</h3>
                    <ul>
                        <li>âœ… <strong>Prepared Statements:</strong> Ø§ÙØµÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù† Ø§Ù„ÙƒÙˆØ¯ Ø¯Ø§Ø¦Ù…Ø§Ù‹.</li>
                        <li>ğŸ§¹ <strong>Input Validation:</strong> ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ù‡ÙŠ Ù…Ø§ ØªØªÙˆÙ‚Ø¹Ù‡ ÙÙ‚Ø·.</li>
                        <li>ğŸš« <strong>Least Privilege:</strong> Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… Ø­Ø³Ø§Ø¨ root Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</li>
                    </ul>
                </div>
            </div>

            <div class="col-md-7 lab-section">
                <h2><i class="fas fa-flask"></i> Ø§Ù„Ù„Ø§Ø¨ Ø§Ù„Ø¹Ù…Ù„ÙŠ</h2>
                <div class="login-card mt-4">
                    <h3 class="text-center mb-4">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Admin Panel)</h3>
                    <div class="alert alert-info text-center">
                        <small>Ø­Ø§ÙˆÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ± (admin) Ø¨Ø¯ÙˆÙ† Ù…Ø¹Ø±ÙØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±!</small>
                    </div>
                    <form id="loginForm">
                        <div class="mb-3">
                            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                            <input type="text" class="form-control flag-input" id="username" placeholder="Username"
                                required>
                        </div>
                        <div class="mb-3">
                            <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                            <input type="password" class="form-control flag-input" id="password" placeholder="Password"
                                required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Ø¯Ø®ÙˆÙ„</button>
                    </form>
                    <div id="loginResult" class="mt-3"></div>
                </div>

                <div class="mt-4 text-center">
                    <p class="text-muted">Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ø°ÙŠ ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©:</p>
                    <div class="code-block text-start" id="queryDisplay">
                        SELECT * FROM users WHERE username = '...' AND password = '...'
                    </div>
                </div>

                <button class="btn btn-secondary mt-3" onclick="resetLab()">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
            </div>
        </div>
    </div>

    <script>
        let tasks = [false, false];

        // Live query update
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const queryDisplay = document.getElementById('queryDisplay');

        function updateQueryDisplay() {
            const u = usernameInput.value || '...';
            const p = passwordInput.value || '...';
            queryDisplay.innerHTML = `SELECT * FROM users WHERE username = '<span class="text-warning">${u}</span>' AND password = '<span class="text-warning">${p}</span>'`;
        }

        usernameInput.addEventListener('input', updateQueryDisplay);
        passwordInput.addEventListener('input', updateQueryDisplay);

        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const user = usernameInput.value;
            const pass = passwordInput.value;
            const result = document.getElementById('loginResult');

            // Simple simulation of SQL Injection
            // If the input contains ' OR '1'='1 (or similar variants)
            const injectionPatterns = [
                "' or '1'='1",
                "' OR '1'='1",
                '" or "1"="1',
                "' or 1=1",
                "' OR 1=1"
            ];

            let isInjected = false;
            for (let pattern of injectionPatterns) {
                if (user.includes(pattern)) {
                    isInjected = true;
                    break;
                }
            }

            if (isInjected) {
                result.innerHTML = `
                    <div class="alert alert-success border-success">
                        <h4><i class="fas fa-unlock"></i> ØªÙ… Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ù†Ø¸Ø§Ù…!</h4>
                        <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù…Ø¯ÙŠØ±! Ù„Ù‚Ø¯ ØªØ¬Ø§ÙˆØ²Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­.</p>
                        <hr>
                        <p class="mb-0">Ø¥Ù„ÙŠÙƒ Ø§Ù„Ù€ Flag Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:</p>
                        <div class="code-block mt-2 fs-5">FLAG{sql_injection_master}</div>
                    </div>
                `;
                if (!tasks[0]) {
                    tasks[0] = true;
                    document.getElementById('task1').classList.add('completed');
                    document.getElementById('check1').checked = true;
                }
                if (!tasks[1]) {
                    tasks[1] = true;
                    document.getElementById('task2').classList.add('completed');
                    document.getElementById('check2').checked = true;
                }
            } else {
                result.innerHTML = `
                    <div class="alert alert-danger">
                        <i class="fas fa-times-circle"></i> ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„! <br>
                        <small>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.</small>
                    </div>
                `;
            }
        });

        function showHint(n) { document.getElementById('hint' + n).style.display = 'block'; }

        function checkFlag() {
            const input = document.getElementById('flagInput').value.trim();
            const result = document.getElementById('flagResult');
            if (input === 'FLAG{sql_injection_master}') {
                result.innerHTML = '<div class="alert alert-success"><i class="fas fa-trophy"></i> ØµØ­ÙŠØ­! ğŸ‰</div>';
            } else if (input) {
                result.innerHTML = '<div class="alert alert-danger">Ø®Ø·Ø£!</div>';
            }
        }

        function resetLab() {
            tasks = [false, false];
            document.querySelectorAll('.task-item').forEach(t => t.classList.remove('completed'));
            document.querySelectorAll('input[type="checkbox"]').forEach(c => c.checked = false);
            document.querySelectorAll('.hint-content').forEach(h => h.style.display = 'none');
            document.getElementById('loginResult').innerHTML = '';
            document.getElementById('flagInput').value = '';
            document.getElementById('flagResult').innerHTML = '';
            usernameInput.value = '';
            passwordInput.value = '';
            updateQueryDisplay();
        }
    </script>
</body>

</html>