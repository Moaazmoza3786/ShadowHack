<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Proxy</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="p-4">
    <div class="container" style="max-width: 700px;">
        <h2>üñºÔ∏è Image Proxy Service</h2>
        <p class="text-muted">Load images from any URL</p>

        <div class="card">
            <div class="card-body">
                <form id="proxyForm">
                    <div class="mb-3">
                        <label>Image URL:</label>
                        <input type="text" id="imageUrl" class="form-control"
                            placeholder="https://example.com/image.jpg" required>
                        <small class="text-muted">Try: https://picsum.photos/400/300</small>
                    </div>
                    <button type="submit" class="btn btn-primary">Load Image</button>
                </form>

                <div id="result" class="mt-4"></div>
            </div>
        </div>

        <div class="alert alert-info mt-4">
            <strong>üí° Hint:</strong> What if you try to access internal resources?<br>
            Try: <code>http://localhost</code> or <code>http://127.0.0.1</code> or <code>http://192.168.1.100</code>
        </div>
    </div>

    <script>
        document.getElementById('proxyForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const url = document.getElementById('imageUrl').value;
            const result = document.getElementById('result');

            // Simulate SSRF vulnerability
            if (url.includes('localhost') || url.includes('127.0.0.1') || url.includes('192.168')) {
                result.innerHTML = `
                    <div class="alert alert-warning">
                        <strong>‚ö†Ô∏è Internal Resource Accessed!</strong><br>
                        URL: ${url}<br>
                        <hr>
                        <strong>Simulated Response:</strong><br>
                        <pre>Internal Server: 192.168.1.100
Status: Active
Services: SSH (22), HTTP (80), MySQL (3306)

FLAG{ssrf_internal_access}</pre>
                    </div>
                `;
            } else if (url.startsWith('http')) {
                result.innerHTML = `
                    <div class="alert alert-success">
                        Loading image from: ${url}
                    </div>
                    <img src="${url}" class="img-fluid mt-2" onerror="this.src='https://via.placeholder.com/400x300?text=Image+Not+Found'">
                `;
            } else {
                result.innerHTML = '<div class="alert alert-danger">Invalid URL</div>';
            }
        });
    </script>
</body>

</html>